<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
	<link href="../css/style.css" rel="stylesheet">
	<link href="../css/responsive.css" rel="stylesheet">

</head>

<body>	
	<section id="form">
		<div class="container">
			<div class="row">
				<div class="col-sm-4 col-sm-offset-1">
					<div class="login-form">
						<h2>Sign In to Your Account</h2>
						
						<form action="">
							<input type="email" placeholder="Email Address" />
							<input type="password" placeholder="Password" />
							<span>
								<input type="checkbox" class="checkbox" id="showpass">
								<label for="showpass">Show Password</label> 
							</span>
							<span style="float: right;">
								<a href="">Forgot Password</a>
							</span>
							<button type="submit" class="btn btn-default">Sign In</button>
						</form>

					</div>
				</div>
				<div class="col-sm-1">
					<h2 class="or">OR</h2>
				</div>
				<div class="col-sm-4">
					<div class="signup-form">
						<h2>New User Sign Up!</h2>
						
						<form id = "sign_in" action="http://localhost:8080/registerUserAsBuyer" method="POST">
							<input type="text" id="sign_in_username" name="username" placeholder="Username"/>
							<input type="email" id="sign_in_email" name="email" placeholder="Email Address"/>
							<input type="password" id="sign_in_pwd" name="password" placeholder="Password"/>
							
							<button type="submit" class="btn btn-default">Sign Up</button>
						</form>

					</div>
				</div>
			</div>
		</div>
	</section>
	
	<script>
		const signInForm = document.getElementById("sign_in");
		
		signInForm.addEventListener("submit", function(e){
			e.preventDefault();

			if(validation() == true){
				const data = new FormData(signInForm);

				const usernameVar = data.get("username");
				const emailVar = data.get("email");
				const pwdVar = data.get("password");

				var object = {};
				object["id"] = 7;
				data.forEach(function(value, key){
					object[key] = value;
				});
				object["accountType"] = "Buyer";
				object["contactNo"] = "NA";
				object["deliveryAddress"] = "NA";
				object["storeName"] = "NA";
				object["storeAddress"] = "NA";
				object["paymentAccountName"] = "NA";
				object["paymentAccountNo"] = "NA";
				object["paymentAccountBankName"] = "NA";
				object["paymentAccountBankBranchName"] = "NA";

				var jsonText = JSON.stringify(object);
				
				fetch("http://localhost:8080/registerUserAsBuyer", {
					method: "POST",
					headers: {
						'Accept': 'application/json',
						'Content-Type': 'application/json'
					},
					body: jsonText
				})
				.then(response => response.text())
				.then(alert("Registration Successful"))
				.catch(error => console.log('Authorization failed: ' + error.message));
			}

			
		})

		function validation(){
			let response = fetch("http://localhost:8080/usersList");
			// console.log(response);
			return true;
		}
	</script>

	<script src="../js/script.js"></script>

</body>
</html>
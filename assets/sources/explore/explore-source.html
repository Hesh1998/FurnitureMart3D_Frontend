<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
	<link href="../css/bootstrap.min.css" rel="stylesheet">
	<link href="../css/font-awesome.min.css" rel="stylesheet">
	<link href="../css/style.css" rel="stylesheet">
	<link href="../css/responsive.css" rel="stylesheet">
	<link href="alert-style.css" rel="stylesheet">
</head>

<body>
	<div class="container" style="padding-top: 120px;">
		<div class="row">
			<div class="col-sm-3">
				<div class="left-sidebar">
					<div class="brands_products">
						<div class="brands-name">
							<h3 style="padding-bottom: 5px;">Search Products</h3>
							<div class="search_box">
								<input id="searchText" type="text" placeholder="Search" style="font-weight: 500; color: #696763;">
							</div>
						</div>
					</div>
					
					<div class="brands_products" style="padding-top: 10px;">
						<div class="brands-name">
							<ul class="nav nav-pills nav-stacked">
								<h3 style="padding-bottom: 5px;">Item Type</h3>
								<li>
									<input type="checkbox" id="chair" value="chair" onclick="FilterProducts()">
									<label for="chair"> Chair </label><br>
								</li>
								<li>
									<input type="checkbox" id="table" value="table" onclick="FilterProducts()">
									<label for="table"> Table  </label><br>
								</li>
								<li>
									<input type="checkbox" id="sofa" value="sofa" onclick="FilterProducts()">
									<label for="sofa"> Sofa </label><br>
								</li>
								<li>
									<input type="checkbox" id="cupboard" value="cupboard" onclick="FilterProducts()">
									<label for="cupboard"> Cupboard </label><br>
								</li>
								<li>
									<input type="checkbox" id="bed" value="bed" onclick="FilterProducts()">
									<label for="bed"> Bed </label><br>
								</li>
								<li>
									<input type="checkbox" id="bench" value="bench" onclick="FilterProducts()">
									<label for="bench"> Bench </label><br>
								</li>
								<li>
									<input type="checkbox" id="bookcase" value="bookcase" onclick="FilterProducts()">
									<label for="bookcase"> Bookcase </label><br>
								</li> 	
								<li>
									<input type="checkbox" id="desk" value="desk" onclick="FilterProducts()">
									<label for="desk"> Desk </label><br>
								</li> 
								<li>
									<input type="checkbox" id="other" value="other" onclick="FilterProducts()">
									<label for="other"> Other </label><br>
								</li> 
							</ul>
						</div>
					</div>

					<div class="brands_products" style="padding-top: 10px;">
						<div class="brands-name">
							<ul class="nav nav-pills nav-stacked">
								<h3 style="padding-bottom: 5px;">Price Range</h3>
								<li>
									<input type="checkbox" id="pr1" value="pr1" onclick="FilterProducts()">
									<label for="pr1"> Less than LKR 50 K </label><br>
								</li>
								<li>
									<input type="checkbox" id="pr2" value="pr2" onclick="FilterProducts()">
									<label for="pr2"> LKR 50 K - LKR 150 K </label><br>
								</li>
								<li>
									<input type="checkbox" id="pr3" value="pr3" onclick="FilterProducts()">
									<label for="pr3"> LKR 150 K - LKR 200 K </label><br>
								</li>
								<li>
									<input type="checkbox" id="pr4" value="pr4" onclick="FilterProducts()">
									<label for="pr4"> LKR 200 K - LKR 250 K </label><br>
								</li>
								<li>
									<input type="checkbox" id="pr5" value="pr5" onclick="FilterProducts()">
									<label for="pr5"> LKR 250 K - LKR 300 K </label><br>
								</li>
								<li>
									<input type="checkbox" id="pr6" value="pr6" onclick="FilterProducts()">
									<label for="pr6"> LKR 300 K and higher </label><br>
								</li>
							</ul>
						</div>
					</div>

					<div class="brands_products" style="padding-top: 10px;">
						<div class="brands-name">
							<ul class="nav nav-pills nav-stacked">
								<h3 style="padding-bottom: 5px;">Location</h3>
								<li>
									<input type="checkbox" id="living" value="living" onclick="FilterProducts()">
									<label for="living"> Living Room </label><br>
								</li>
								<li>
									<input type="checkbox" id="dining" value="dining" onclick="FilterProducts()">
									<label for="dining"> Dining </label><br>
								</li>
								<li>
									<input type="checkbox" id="bedroom" value="bedroom" onclick="FilterProducts()">
									<label for="bedroom"> Bedroom </label><br>
								</li>
								<li>
									<input type="checkbox" id="office" value="office" onclick="FilterProducts()">
									<label for="office"> Office </label><br>
								</li>
								<li>
									<input type="checkbox" id="outdoor" value="outdoor" onclick="FilterProducts()">
									<label for="outdoor"> Outdoor </label><br>
								</li>
								<li>
									<input type="checkbox" id="otherN" value="otherN" onclick="FilterProducts()">
									<label for="otherN"> Other </label><br>
								</li>
							</ul>
						</div>
					</div>

					

					<div class="brands_products" style="padding-top: 10px;">
						<div class="brands-name">
							<ul class="nav nav-pills nav-stacked">
								<h3 style="padding-bottom: 5px;">Category</h3>
								<li>
									<input type="checkbox" id="classy" value="classy" onclick="FilterProducts()">
									<label for="classy"> Classy </label><br>
								</li>
								<li>
									<input type="checkbox" id="antique" value="antique" onclick="FilterProducts()">
									<label for="antique"> Antique </label><br>
								</li>
								<li>
									<input type="checkbox" id="traditional" value="traditional" onclick="FilterProducts()">
									<label for="traditional"> Traditional </label><br>
								</li>
								<li>
									<input type="checkbox" id="modern" value="modern" onclick="FilterProducts()">
									<label for="modern"> Modern </label><br>
								</li>
								<li>
									<input type="checkbox" id="contemporary" value="contemporary" onclick="FilterProducts()">
									<label for="contemporary"> Contemporary </label><br>
								</li>
								<li>
									<input type="checkbox" id="transitional" value="transitional" onclick="FilterProducts()">
									<label for="transitional"> Transitional </label><br>
								</li>
								<li>
									<input type="checkbox" id="coastal" value="coastal" onclick="FilterProducts()">
									<label for="coastal"> Coastal </label><br>
								</li>
								<li>
									<input type="checkbox" id="minimalist" value="minimalist" onclick="FilterProducts()">
									<label for="minimalist"> Minimalist </label><br>
								</li>
							</ul>
						</div>
					</div>

				</div>
			</div>
			
			<div class="col-sm-9 padding-right">
				<div class="features_items" id="products_list_view">

				</div>
			</div>

		</div>
	</div>


	<div class="toast" style="position: absolute;"> </div>

	<script src="../../framework/bootstrap/js/bootstrap.bundle.min.js"></script>
	<script src="../../alert-box/alert-script.js"></script>
    <script src="../js/script.js"></script>
		

	<script>
		// Arrays to store searched / filtered product details
		var arrSellerIds = [];
		var arrItemIds = [];
		var arrTotalSoldCounts = [];
		var arrYesNo = [];
		var arrYesNo1 = [];
		var arrYesNo2 = [];
		var arrYesNo3 = [];
		var arrYesNoAll = [];
		var arrSellerIdsFilter = [];
		var arrItemIdsFilter = [];


		arrSellerIds.length = 0;
		arrItemIds.length = 0;
		arrTotalSoldCounts.length = 0;
		arrYesNo.length = 0;
		arrYesNo1.length = 0;
		arrYesNo2.length = 0;
		arrYesNo3.length = 0;
		arrYesNoAll.length = 0;
		arrSellerIdsFilter.length = 0;
		arrItemIdsFilter.length = 0;


		// Display products stored in (arrSellerIds + arrItemIds) arrays
		const setProducts = async() => {
			let response = await fetch("http://localhost:8080/getAllProducts");
			let products = await response.json();

			var productList = "";


			for(let j = 0; j < arrSellerIds.length; j++){
				for(let i = 0; i < products.length; i++){
					if(arrSellerIds[j] == products[i].userId && arrItemIds[j] == products[i].itemId){
						productList += `<div class="col-sm-4"> <div class="product-image-wrapper"> <div class="single-products"> <div class="productinfo text-center"> <img src="${products[i].clr1Img}" alt="" /> <h2>LKR ${(products[i].price).toLocaleString('en-US')}</h2> <p>${products[i].itemName}</p> <a href="" class="btn btn-default add-to-cart" onclick="openItemView(${products[i].userId}, ${products[i].itemId})">View Details</a></div></div><div class="choose"><ul class="nav nav-pills nav-justified"><li><a href="#" onclick="addToCart(${products[i].userId}, ${products[i].itemId})">Add to Cart</a></li><li><a href="#" onclick="addToWishlist(${products[i].userId}, ${products[i].itemId})">Add to Wishlist</a></li></ul></div></div></div>`;
						break;
					}
				}
			}
			

			document.getElementById("products_list_view").innerHTML = productList;

			document.getElementById("chair").checked = false;
			document.getElementById("table").checked = false;
			document.getElementById("sofa").checked = false;
			document.getElementById("cupboard").checked = false;
			document.getElementById("bed").checked = false;
			document.getElementById("bench").checked = false;
			document.getElementById("bookcase").checked = false;
			document.getElementById("desk").checked = false;
			document.getElementById("other").checked = false;

			document.getElementById("pr1").checked = false;
			document.getElementById("pr2").checked = false;
			document.getElementById("pr3").checked = false;
			document.getElementById("pr4").checked = false;
			document.getElementById("pr5").checked = false;
			document.getElementById("pr6").checked = false;

			document.getElementById("living").checked = false;
			document.getElementById("dining").checked = false;
			document.getElementById("bedroom").checked = false;
			document.getElementById("office").checked = false;
			document.getElementById("outdoor").checked = false;
			document.getElementById("otherN").checked = false;

			document.getElementById("classy").checked = false;
			document.getElementById("antique").checked = false;
			document.getElementById("traditional").checked = false;
			document.getElementById("modern").checked = false;
			document.getElementById("contemporary").checked = false;
			document.getElementById("transitional").checked = false;
			document.getElementById("coastal").checked = false;
			document.getElementById("minimalist").checked = false;
		}


		// All products added to the product details arrays in trending order - When page is loaded
		const setAllProducts = async() => {
			let response3 = await fetch("http://localhost:8080/getAllProducts");
			let products3 = await response3.json();

			arrSellerIds = [];
			arrItemIds = [];
			arrTotalSoldCounts = [];
			arrSellerIds.length = 0;
			arrItemIds.length = 0;
			arrTotalSoldCounts.length = 0;

			arrSellerIds.length = products3.length;
			arrItemIds.length = products3.length;
			arrTotalSoldCounts.length = products3.length;


			for(let i = 0; i < products3.length; i++){
				arrSellerIds[i] = products3[i].userId;
				arrItemIds[i] = products3[i].itemId;
				arrTotalSoldCounts[i] = products3[i].totalSold;
			}

			
			// Sort based on total sales
			for(let i = 0; i < products3.length; i++){
				for(let j = 0; j < (products3.length - i -1); j++){
					if(arrTotalSoldCounts[j] < arrTotalSoldCounts[j+1]){
						var temp1 = arrTotalSoldCounts[j];
						arrTotalSoldCounts[j] = arrTotalSoldCounts[j+1];
						arrTotalSoldCounts[j+1] = temp1;
						
						var temp2 = arrSellerIds[j];
						arrSellerIds[j] = arrSellerIds[j+1];
						arrSellerIds[j+1] = temp2;

						var temp3 = arrItemIds[j];
						arrItemIds[j] = arrItemIds[j+1];
						arrItemIds[j+1] = temp3;
					}
				}
			}


			// Display products in the page
			setProducts();
		}

		setAllProducts();


		// Searched products added to the product details arrays in trending order
		const setSearchedProducts = async() => {
			arrSellerIds = [];
			arrItemIds = [];
			arrTotalSoldCounts = [];
			arrSellerIds.length = 0;
			arrItemIds.length = 0;
			arrTotalSoldCounts.length = 0;	


			if(document.getElementById("searchText").value == ""){
				setAllProducts();
			}else{
				let response4 = await fetch("http://localhost:8080/getAllProducts");
				let products4 = await response4.json();

				var k = 0;

				for(let i = 0; i < products4.length; i++){
					if(((products4[i].itemName).toLowerCase()).includes((document.getElementById("searchText").value).toLowerCase()) || ((products4[i].description).toLowerCase()).includes((document.getElementById("searchText").value).toLowerCase())){
						arrSellerIds.length = arrSellerIds.length + 1;
						arrItemIds.length = arrItemIds.length + 1;
						arrTotalSoldCounts.length = arrTotalSoldCounts.length + 1;	

						arrSellerIds[k] = products4[i].userId;
						arrItemIds[k] = products4[i].itemId;
						arrTotalSoldCounts[k] = products4[i].totalSold;

						k++;
					}
				}


				// Sort based on total sales
				for(let i = 0; i < arrSellerIds.length; i++){
					for(let j = 0; j < (arrSellerIds.length - i -1); j++){
						if(arrTotalSoldCounts[j] < arrTotalSoldCounts[j+1]){
							var temp1 = arrTotalSoldCounts[j];
							arrTotalSoldCounts[j] = arrTotalSoldCounts[j+1];
							arrTotalSoldCounts[j+1] = temp1;
							
							var temp2 = arrSellerIds[j];
							arrSellerIds[j] = arrSellerIds[j+1];
							arrSellerIds[j+1] = temp2;

							var temp3 = arrItemIds[j];
							arrItemIds[j] = arrItemIds[j+1];
							arrItemIds[j+1] = temp3;
						}
					}
				}


				// Display products in the page
				setProducts();
			}

		}


		// Enter button pressed when searching
		var inputText = document.getElementById("searchText");
		inputText.addEventListener("keypress", function(event) {
			if (event.key === "Enter") {
				event.preventDefault();
				setSearchedProducts();
			}
		});


		// Display products stored in (arrSellerIdsFilter + arrItemIdsFilter) arrays
		// Display filtered products
		const setFilteredProducts = async() => {
			let response = await fetch("http://localhost:8080/getAllProducts");
			let products = await response.json();

			var productList = "";


			for(let j = 0; j < arrSellerIdsFilter.length; j++){
				for(let i = 0; i < products.length; i++){
					if(arrSellerIdsFilter[j] == products[i].userId && arrItemIdsFilter[j] == products[i].itemId){
						productList += `<div class="col-sm-4"> <div class="product-image-wrapper"> <div class="single-products"> <div class="productinfo text-center"> <img src="${products[i].clr1Img}" alt="" /> <h2>LKR ${(products[i].price).toLocaleString('en-US')}</h2> <p>${products[i].itemName}</p> <a href="" class="btn btn-default add-to-cart" onclick="openItemView(${products[i].userId}, ${products[i].itemId})">View Details</a></div></div><div class="choose"><ul class="nav nav-pills nav-justified"><li><a href="#" onclick="addToCart(${products[i].userId}, ${products[i].itemId})">Add to Cart</a></li><li><a href="#" onclick="addToWishlist(${products[i].userId}, ${products[i].itemId})">Add to Wishlist</a></li></ul></div></div></div>`;
						break;
					}
				}
			}
			

			document.getElementById("products_list_view").innerHTML = productList;
		}


		// Filter products algorithm - All products or for a specific search
		const FilterProducts = async() => {
			arrSellerIdsFilter = [];
			arrSellerIdsFilter.length = 0;
			arrItemIdsFilter = [];
			arrItemIdsFilter.length = 0;
			arrYesNo = [];
			arrYesNo.length = 0;
			arrYesNo1 = [];
			arrYesNo1.length = 0;
			arrYesNo2 = [];
			arrYesNo2.length = 0;
			arrYesNo3 = [];
			arrYesNo3.length = 0;
			arrYesNoAll = [];
			arrYesNoAll.length = 0;


			arrYesNo.length = arrSellerIds.length;
			arrYesNo1.length = arrSellerIds.length;
			arrYesNo2.length = arrSellerIds.length;
			arrYesNo3.length = arrSellerIds.length;
			arrYesNoAll.length = arrSellerIds.length;
			arrSellerIdsFilter.length = arrSellerIds.length;
			arrItemIdsFilter.length = arrSellerIds.length;

			for(let i = 0; i < arrSellerIds.length; i++){
				arrYesNo[i] = "N";
			}

			for(let i = 0; i < arrSellerIds.length; i++){
				arrYesNo1[i] = "N";
			}

			for(let i = 0; i < arrSellerIds.length; i++){
				arrYesNo2[i] = "N";
			}

			for(let i = 0; i < arrSellerIds.length; i++){
				arrYesNo3[i] = "N";
			}

			for(let i = 0; i < arrSellerIds.length; i++){
				arrYesNoAll[i] = "N";
			}

			for(let i = 0; i < arrSellerIds.length; i++){
				arrSellerIdsFilter[i] = arrSellerIds[i];
			}

			for(let i = 0; i < arrSellerIds.length; i++){
				arrItemIdsFilter[i] = arrItemIds[i];
			}


			let response5 = await fetch("http://localhost:8080/getAllProducts");
			let products5 = await response5.json();


			// Filter products based on Item Type
			for(let j = 0; j < arrSellerIdsFilter.length; j++){
				for(let i = 0; i < products5.length; i++){
					if(arrSellerIdsFilter[j] == products5[i].userId && arrItemIdsFilter[j] == products5[i].itemId){
						if(document.getElementById("chair").checked == true && products5[i].chair == "true"){
							arrYesNo[j] = "Y";
						}

						if(document.getElementById("table").checked == true && products5[i].table == "true"){
							arrYesNo[j] = "Y";
						}

						if(document.getElementById("sofa").checked == true && products5[i].sofa == "true"){
							arrYesNo[j] = "Y";
						}

						if(document.getElementById("cupboard").checked == true && products5[i].cupboard == "true"){
							arrYesNo[j] = "Y";
						}

						if(document.getElementById("bed").checked == true && products5[i].bed == "true"){
							arrYesNo[j] = "Y";
						}

						if(document.getElementById("bench").checked == true && products5[i].bench == "true"){
							arrYesNo[j] = "Y";
						}

						if(document.getElementById("bookcase").checked == true && products5[i].bookcase == "true"){
							arrYesNo[j] = "Y";
						}

						if(document.getElementById("desk").checked == true && products5[i].desk == "true"){
							arrYesNo[j] = "Y";
						}

						if(document.getElementById("other").checked == true && products5[i].otherT == "true"){
							arrYesNo[j] = "Y";
						}
					}
				}
			}


			if(document.getElementById("chair").checked == false && document.getElementById("table").checked == false && document.getElementById("sofa").checked == false && document.getElementById("cupboard").checked == false && document.getElementById("bed").checked == false && document.getElementById("bench").checked == false && document.getElementById("bookcase").checked == false && document.getElementById("desk").checked == false && document.getElementById("other").checked == false){
				for(let j = 0; j < arrSellerIdsFilter.length; j++){
					arrYesNo[j] = "Y";
				}	
			}
			

			// Filter products based on Price Range
			for(let j = 0; j < arrSellerIdsFilter.length; j++){
				for(let i = 0; i < products5.length; i++){
					if(arrSellerIdsFilter[j] == products5[i].userId && arrItemIdsFilter[j] == products5[i].itemId){
						if(document.getElementById("pr1").checked == true && products5[i].price < 50000){
							arrYesNo1[j] = "Y";
						}

						if(document.getElementById("pr2").checked == true && products5[i].price >= 50000 && products5[i].price <= 150000){
							arrYesNo1[j] = "Y";
						}

						if(document.getElementById("pr3").checked == true && products5[i].price >= 150000 && products5[i].price <= 200000){
							arrYesNo1[j] = "Y";
						}
						
						if(document.getElementById("pr4").checked == true && products5[i].price >= 200000 && products5[i].price <= 250000){
							arrYesNo1[j] = "Y";
						}

						if(document.getElementById("pr5").checked == true && products5[i].price >= 250000 && products5[i].price <= 300000){
							arrYesNo1[j] = "Y";
						}

						if(document.getElementById("pr6").checked == true && products5[i].price >= 300000){
							arrYesNo1[j] = "Y";
						}
						
					}
				}
			}


			if(document.getElementById("pr1").checked == false && document.getElementById("pr2").checked == false && document.getElementById("pr3").checked == false && document.getElementById("pr4").checked == false && document.getElementById("pr5").checked == false && document.getElementById("pr6").checked == false){
				for(let j = 0; j < arrSellerIdsFilter.length; j++){
					arrYesNo1[j] = "Y";
				}	
			}
			

			// Filter products based on Location
			for(let j = 0; j < arrSellerIdsFilter.length; j++){
				for(let i = 0; i < products5.length; i++){
					if(arrSellerIdsFilter[j] == products5[i].userId && arrItemIdsFilter[j] == products5[i].itemId){
						if(document.getElementById("living").checked == true && products5[i].living == "true"){
							arrYesNo2[j] = "Y";
						}

						if(document.getElementById("dining").checked == true && products5[i].dining == "true"){
							arrYesNo2[j] = "Y";
						}

						if(document.getElementById("bedroom").checked == true && products5[i].bedroom == "true"){
							arrYesNo2[j] = "Y";
						}

						if(document.getElementById("office").checked == true && products5[i].office == "true"){
							arrYesNo2[j] = "Y";
						}

						if(document.getElementById("outdoor").checked == true && products5[i].outdoor == "true"){
							arrYesNo2[j] = "Y";
						}

						if(document.getElementById("otherN").checked == true && products5[i].other == "true"){
							arrYesNo2[j] = "Y";
						}
					}
				}
			}


			if(document.getElementById("living").checked == false && document.getElementById("dining").checked == false && document.getElementById("bedroom").checked == false && document.getElementById("office").checked == false && document.getElementById("outdoor").checked == false && document.getElementById("otherN").checked == false){
				for(let j = 0; j < arrSellerIdsFilter.length; j++){
					arrYesNo2[j] = "Y";
				}	
			}


			// Filter products based on Category
			for(let j = 0; j < arrSellerIdsFilter.length; j++){
				for(let i = 0; i < products5.length; i++){
					if(arrSellerIdsFilter[j] == products5[i].userId && arrItemIdsFilter[j] == products5[i].itemId){
						if(document.getElementById("classy").checked == true && products5[i].classy == "true"){
							arrYesNo3[j] = "Y";
						}
						
						if(document.getElementById("antique").checked == true && products5[i].antique == "true"){
							arrYesNo3[j] = "Y";
						}

						if(document.getElementById("traditional").checked == true && products5[i].traditional == "true"){
							arrYesNo3[j] = "Y";
						}

						if(document.getElementById("modern").checked == true && products5[i].modern == "true"){
							arrYesNo3[j] = "Y";
						}

						if(document.getElementById("contemporary").checked == true && products5[i].contemporary == "true"){
							arrYesNo3[j] = "Y";
						}

						if(document.getElementById("transitional").checked == true && products5[i].transitional == "true"){
							arrYesNo3[j] = "Y";
						}

						if(document.getElementById("coastal").checked == true && products5[i].coastal == "true"){
							arrYesNo3[j] = "Y";
						}

						if(document.getElementById("minimalist").checked == true && products5[i].minimalist == "true"){
							arrYesNo3[j] = "Y";
						}
					}
				}
			}


			if(document.getElementById("classy").checked == false && document.getElementById("antique").checked == false && document.getElementById("traditional").checked == false && document.getElementById("modern").checked == false && document.getElementById("contemporary").checked == false && document.getElementById("transitional").checked == false && document.getElementById("coastal").checked == false && document.getElementById("minimalist").checked == false){
				for(let j = 0; j < arrSellerIdsFilter.length; j++){
					arrYesNo3[j] = "Y";
				}	
			}


			// Get the intersection set of all applied filters
			for(let j = 0; j < arrSellerIdsFilter.length; j++){
				if(arrYesNo[j] == "Y" && arrYesNo1[j] == "Y" && arrYesNo2[j] == "Y" && arrYesNo3[j] == "Y"){
					arrYesNoAll[j] = "Y";
				}else{
					arrYesNoAll[j] = "N";
				}
			}	


			// Set the arrays arrSellerIdsFilter and arrItemIdsFilter
			for(let j = 0; j < arrSellerIdsFilter.length; j++){
				if(arrYesNoAll[j] != "Y"){
					arrSellerIdsFilter[j] = 0;
					arrItemIdsFilter[j] = 0;
				}
			}
			

			// Display the filtered product list in the web page
			setFilteredProducts();
		}



		// Buyer id
		var buyerId = localStorage.getItem("id");


		// View selected item details
		const openItemView = async(userId, itemId) =>{
			localStorage.setItem("sellerId", userId);
			localStorage.setItem("productId", itemId);
			open("../../../item-demo.html", "_parent");
		}


		// Add selected item to cart
		const addToCart = async(sellerID, itemID) => {
			if(buyerId == null){
				open("../../../../sign-in.html", "_blank");
			}else if(buyerId == sellerID){
				errorToast("This is a product added by you. Please note that you can't add your own products to cart.");
			}else{
				let response1 = await fetch(`http://localhost:8080/findUserProducts/${sellerID}`);
				let items = await response1.json();
				
				var stock = 0;
				
				for (let i = 0; i < items.length; i++) {
					if(items[i].itemId == itemID){
						stock = items[i].stockClr1 + items[i].stockClr2 + items[i].stockClr3;
						break;
					}
				}

				if(stock <= 0){
					errorToast("Item out of stock!");
				}else{
					var available = false;

					let response2 = await fetch(`http://localhost:8080/findCartItems/${buyerId}`);
					let cartItems = await response2.json();

					for (let i = 0; i < cartItems.length; i++) {
						if(cartItems[i].sellerID == sellerID & cartItems[i].productID == itemID){
							available = true;
							break;
						}
					}

					if(available == true){
						errorToast("Iteam already added to cart!");
					}else{
						var object2 = {};
						object2["id"] = buyerId;
						object2["sellerID"] = sellerID;
						object2["productID"] = itemID;

						var jsonText2 = JSON.stringify(object2);
						
						await fetch("http://localhost:8080/addItemToCart", {
							method: "POST",
							headers: {
								'Accept': 'application/json',
								'Content-Type': 'application/json'
							},
							body: jsonText2
						})
						.then(response => response.text())
						.then(infoToast("Item added to your cart!"))
						.catch(error => console.log('Authorization failed: ' + error.message));	
					}					
				}
			}
		}


		// Add selected item to wishlist
		const addToWishlist = async(sellerID, itemID) => {
			if(buyerId == null){
				open("../../../../sign-in.html", "_blank");
			}else if(buyerId == sellerID){
				errorToast("This is a product added by you. Please note that you can't add your own products to wishlist.");
			}else{
				var available = false;

				let response2 = await fetch(`http://localhost:8080/findWishlistItems/${buyerId}`);
				let wishlistItems = await response2.json();

				for (let i = 0; i < wishlistItems.length; i++) {
					if(wishlistItems[i].sellerID == sellerID & wishlistItems[i].productID == itemID){
						available = true;
						break;
					}
				}

				if(available == true){
					errorToast("Iteam already added to wishlist!");
				}else{
					var object2 = {};
					object2["id"] = buyerId;
					object2["sellerID"] = sellerID;
					object2["productID"] = itemID;

					var jsonText2 = JSON.stringify(object2);
					
					await fetch("http://localhost:8080/addItemToWishlist", {
						method: "POST",
						headers: {
							'Accept': 'application/json',
							'Content-Type': 'application/json'
						},
						body: jsonText2
					})
					.then(response => response.text())
					.then(infoToast("Item added to your wishlist!"))
					.catch(error => console.log('Authorization failed: ' + error.message));
				}
			}
		}
		
	</script>
</body>
</html>